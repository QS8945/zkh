!function(){function t(t,e,a,o,i,n,r,d,l,s){var c=this,m={breakdown_top5:"",colorArr:["#FB743A","#2ACE8C","#CEBF2E","#429BFF","#0FE400"]};c.initData={alarmDeviceInfo:[]},c.initFunctions={initFunc:function(){m.breakdown_top5=Highcharts.chart("breakdown_top5",{chart:{height:360,spacing:[0,0,0,0],margin:[20,40,0,-70],backgroundColor:"rgb(24,32,51)"},credits:{enabled:!1},title:{text:""},tooltip:{pointFormat:"{series.name}: <b>{point.y}</b>"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}},exporting:{enabled:!1},legend:{enabled:!0,align:"right",layout:"vertical",verticalAlign:"top",squareSymbol:!1,borderRadius:0,x:-10,y:20,itemMarginBottom:10,itemStyle:{color:"{point.color}"},itemHoverStyle:{color:"#ffffff"},symbolWidth:16,symbolHeight:7,labelFormatter:function(){return'<span style="color: '+this.color+';line-height:18px">'+this.name+"</span>"}},series:[{type:"pie",innerSize:"70%",name:"市场份额",data:[{name:"系统崩溃",y:24,color:"#FB743A",legendIndex:1},{name:"程序更新",y:16,color:"#2ACE8C"},{name:"插件不兼容",y:24,color:"#CEBF2E"},{name:"操作不当",y:25,color:"#429BFF"},{name:"设备断电",y:11,color:"#0FE400"}]}]}),m.breakdownLine=Highcharts.chart("breakdown_line",{chart:{type:"column",height:220,marginTop:40,marginBottom:30,backgroundColor:"#192033"},colors:["#6176AF"],credits:{enabled:!1},title:{text:""},xAxis:{lineColor:"#1956A6",lineWidth:2,labels:{style:{color:"#A5A7AC",fontSize:10}},tickWidth:1,tickLength:8,tickPosition:"inside",tickColor:"#1956A6",type:"datetime",dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"}},yAxis:{min:0,title:{text:"(分数)",rotation:0,y:-120,x:40,style:{color:"#ffffff"}},lineColor:"#1956A6",lineWidth:2,gridLineColor:"#1C2539",stackLabels:{enabled:!0,style:{fontWeight:"bold",color:Highcharts.theme&&Highcharts.theme.textColor||"gray"}},labels:{style:{color:"#A5A7AC",fontSize:10}},tickPixelInterval:10},legend:{align:"center",x:-30,verticalAlign:"top",y:-10,floating:!0,backgroundColor:Highcharts.theme&&Highcharts.theme.background2||"white",borderColor:"#CCC",borderWidth:1,shadow:!1,borderWidth:0,squareSymbol:!1,symbolWidth:30,symbolHeight:12,symbolRadius:0,backgroundColor:"#192033",itemStyle:{color:"#A5A7AC",fontSize:10},itemWidth:160},exporting:{enabled:!1},tooltip:{formatter:function(){return"<b>"+this.point.name+"</b><br/>总数: "+this.y+"<br/>"}},plotOptions:{column:{dataLabels:{enabled:!1,color:Highcharts.theme&&Highcharts.theme.dataLabelsColor||"white",style:{textOutline:"1px 1px black"}},borderWidth:0,pointPadding:0,showInLegend:!1}},series:[{data:[10,10,10,10,10,100]}]})},getBreakdownTop5List:function(){var t={dataTemplateId:"58d36b454d70a07303000012",dataItemId:"58d36b454d70a07303000027"},e=[{iotObjectId:"11111",dataItemId:$("#breakdown_top5").data("dataitemid")}],i={time:100,iotObjectAndItems:JSON.stringify(e),dtProp:0,uniteTime:0,additionalOper:JSON.stringify(t)};o.getRealRecordByAddOper(i).then(function(t){if(t.data&&t.data.operCode==d.SUCCESS){var e=t.data.data.faultDistribution;if(console.log(e),null!==e&&0!==e.length&&void 0!==e){var o=[];e.forEach(function(t,e,a){t.detailJson&&(t.detailJson=JSON.parse(t.detailJson));for(x in t){var i={name:x,y:parseInt(t[x]),color:m.colorArr[e]};o.push(i)}}),m.breakdown_top5.series[0].update({data:o})}}else a.msg(t.message,{icon:5,shift:6})})},getBreakdownTrend:function(){l.getBreakdownTrend().then(function(t){for(var e=t.data,a=[],o=0;o<e.length;o++){var i={name:e[o].month,y:parseInt(e[o].num),x:s.currentTime(e[o].month)};a.push(i)}console.log(a),m.breakdownLine.series[0].update({data:a})})},getAlarmTop5List:function(){var t={dataTemplateId:"58d36b454d70a07303000012",dataItemId:"58d36b454d70a07303000026"},e=[{iotObjectId:"11111",dataItemId:$("#alarm").data("dataitemid")}],i={time:100,iotObjectAndItems:JSON.stringify(e),dtProp:0,uniteTime:0,additionalOper:JSON.stringify(t)};o.getRealRecordByAddOper(i).then(function(t){if(t.data&&t.data.operCode==d.SUCCESS){var e=t.data.data;console.log(e),null!==e&&0!==e.length&&void 0!==e&&(c.initData.alarmDeviceInfo=e)}else a.msg(t.message,{icon:5,shift:6})})},initDataItems:function(){l.getDataItemListData().then(function(t){for(var e=t.data,a=$(".dataItem"),o=0;o<a.length;o++)for(var i=0;i<e.length;i++)if($(a[o]).data("dataitemname")===e[i].dataItemName){console.log(44),console.log($(a[o]).data("dataitemname")),$(a[o]).data("dataitemid",e[i].dataItemId),e[i].unit&&$(a[o]).data("unit",e[i].unit);break}console.log($("#breakdown").data("dataitemname")),c.initFunctions.getAlarmTop5List(),c.initFunctions.getBreakdownTop5List()})}},c.initFunctions.initFunc(),c.initFunctions.initDataItems(),c.initFunctions.getBreakdownTrend()}angular.module("app.managerModule.statistics.breakdownSta").controller("BreakdownStaController",t),t.$inject=["$scope","$stateParams","layer","API","session","MD5","$state","TEMPLATEDATA","JEEAPI","COMMONJS"]}();