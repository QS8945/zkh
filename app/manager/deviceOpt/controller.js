!function(){function e(e,t,i,n,o,a,s,d,r,l){var m=this,c={initDate:function(){laydate.render({elem:"#productionDate",theme:"#495263",done:function(e,t,i){m.initTools.item.extend.extendS1.productionDate=e}}),laydate.render({elem:"#installDate",theme:"#495263",done:function(e,t,i){m.initTools.item.extend.extendS1.installDate=e}}),laydate.render({elem:"#turnOnDate",theme:"#495263",done:function(e,t,i){m.initTools.item.extend.extendS1.turnOnDate=e}})}};switch(m.initTools={compressors:[{name:"空压机类型1",id:"1"},{name:"空压机类型2",id:"2"},{name:"空压机类型3",id:"3"},{name:"空压机类型4",id:"4"}],compressorBrands:[{name:"空压机品牌1",id:"1"},{name:"空压机品牌2",id:"2"},{name:"空压机品牌3",id:"3"},{name:"空压机品牌4",id:"4"}],compressorModels:[{name:"空压机型号1",id:"1"},{name:"空压机型号2",id:"2"},{name:"空压机型号3",id:"3"},{name:"空压机型号4",id:"4"}],controllerTypes:[{name:"控制器类型1",id:"1"},{name:"控制器类型2",id:"2"},{name:"控制器类型3",id:"3"},{name:"控制器类型4",id:"4"}],noseTypes:[{name:"机头类型1",id:"1"},{name:"机头类型2",id:"2"},{name:"机头类型3",id:"3"},{name:"机头类型4",id:"4"}],frequencies:[{name:"变频",id:"1"},{name:"工频",id:"2"}],devicestatuses:[{name:"启用",id:"0"},{name:"报废",id:"1"}],collectorTypes:[{name:"有人物联",id:"1"},{name:"丹唯思",id:"2"}],collectorNos:[{name:"采集器序列号1",id:"1"},{name:"采集器序列号2",id:"2"},{name:"采集器序列号3",id:"3"},{name:"采集器序列号4",id:"4"}],item:{extend:{extendS1:{compressor:"1",compressorBrand:"1",compressorModel:"1",controllerType:"1",frequency:"1",devicestatus:"0",collectorType:"1",collectorNo:"1"}}},uploadIcon:function(t){var n=t.files[0];if("image/png"!==n.type&&"image/jpeg"!==n.type)return i.msg("请上传jpg或png格式图片");var o=new FileReader;o.onload=function(){var t=n.size,a=l.Logo_Max_Size;if(a*=1024,!(t<=a))return i.msg("请上传2M以内图片");e.$apply(function(){m.initTools.item.previewImg=o.result})},n&&o.readAsDataURL(n)},uploadClick:function(){$("#iconFile").click()},saveForm:function(){var t=e.deviceOpt;if(t.$invalid){var n=t.$error;for(item in n)return $(n[item][0].$$element[0]).focus(),i.msg("请填写正确的信息")}if(!m.initTools.item.previewImg)return i.msg("请上传图片");var a={compressorNum:m.initTools.item.extend.extendS1.compressorNum,compressorBrand:m.initTools.item.extend.extendS1.compressorBrand,compressorModel:m.initTools.item.extend.extendS1.compressorModel,controllerType:m.initTools.item.extend.extendS1.controllerType,ratedPower:m.initTools.item.extend.extendS1.ratedPower,dischargeVolume:m.initTools.item.extend.extendS1.dischargeVolume,frequency:m.initTools.item.extend.extendS1.frequency,devicestatus:m.initTools.item.extend.extendS1.devicestatus,collectorType:m.initTools.item.extend.extendS1.collectorType,collectorNo:m.initTools.item.extend.extendS1.collectorNo,installDate:m.initTools.item.extend.extendS1.installDate,productionDate:m.initTools.item.extend.extendS1.productionDate,turnOnDate:m.initTools.item.extend.extendS1.turnOnDate,responsiblePerson:m.initTools.item.extend.extendS1.responsiblePerson,responsibleTel:m.initTools.item.extend.extendS1.responsibleTel,companyCode:m.initTools.item.extend.extendS1.companyCode},d={name:m.initTools.item.name,userId:"10290",userCode:o.getLocalObject("userInfo").id,iotTypeId:m.initTools.item.extend.extendS1.compressor,iotStationId:m.initTools.item.iotStationId,detailJson:JSON.stringify(a),previewImg:m.initTools.item.previewImg};r.getIotObjectSave(d).then(function(e){"true"===e.data.result&&s.reload()})},getCompanyListData:function(){r.getCompanyListData().then(function(e){var t=e.data;t.length&&(m.initTools.companyListData=t,m.initTools.item.extend.extendS1.companyCode=t[0].companyCode,m.initTools.getIotStationListData(m.initTools.item.extend.extendS1.companyCode))})},getIotStationListData:function(e){r.getIotStationListData({clientCompanyCode:e}).then(function(e){var t=e.data;t.length?(t.forEach(function(e,t,i){e.detailJson&&(e.detailJson=JSON.parse(e.detailJson))}),console.log(t),m.initTools.iotStationListData=t,m.initTools.item.iotStationId=t[0].id):m.initTools.iotStationListData=[]})},removeImg:function(){i.confirm("您确定要清除图片吗",{icon:3},function(e){m.initTools.item.previewImg="",$("#iconFile").val(""),$("#previewImg").attr("src",""),i.close(e)})}},m.initTools.type=t.type,m.initTools.type){case"ins":m.initTools.title="新增设备";break;case"sel":m.initTools.title="设备详情";break;case"upd":m.initTools.title="更新设备"}m.initTools.getCompanyListData(),c.initDate()}angular.module("app.managerModule.deviceOpt").controller("DeviceOptController",e),e.$inject=["$scope","$stateParams","layer","API","session","MD5","$state","TEMPLATEDATA","JEEAPI","COMMONJS"]}();