!function(){function e(e,o,i,t,n,s,l,a,r){var p=this;switch(p.initTools={hide:!1,empUser:{employee:{company:{}}},uploadIcon:function(o){var i=o.files[0],t=new FileReader;t.onload=function(){e.$apply(function(){p.initTools.previewImg=t.result})},i&&t.readAsDataURL(i)},uploadClick:function(){$("#iconFile").click()},saveForm:function(){var o=e.userOpt;if(o.$invalid){var t=o.$error;for(item in t)return $(t[item][0].$$element[0]).focus(),i.msg("请填写正确的信息")}var n={userType:"employee",loginCode:p.initTools.empUser.loginCode,userName:p.initTools.empUser.userName,mobile:p.initTools.empUser.mobile,email:p.initTools.empUser.email,userRoleString:p.initTools.role,"employee.company.companyCode":p.initTools.empUser.employee.company.companyCode,"employee.office.officeName":"defaultName","employee.office.officeCode":"defaultCode",remarks:p.initTools.empUser.remarks};"ins"==p.initTools.type?(n.op="add",n.password=p.initTools.empUser.password,n.oldLoginCode=""):"upd"==p.initTools.type&&(n.op="edit",n.oldLoginCode=p.initTools.empUser.loginCode,n.userCode=p.initTools.empUser.userCode),r.getEmpUserSave(n).then(function(e){"true"===e.data.result&&l.reload()})},getCompanyTreeData:function(){r.getCompanyTreeData().then(function(e){p.initTools.empUser.employee.company.companyCode=p.initTools.empUser.employee.company.companyCode||e.data[0].id,p.initTools.companyCodes=e.data})},getRoles:function(){r.getRoles({userType:"employee"}).then(function(e){p.initTools.role=p.initTools.role||e.data[1].id,p.initTools.roles=e.data})},getEmpUserForm:function(){var e={userCode:o.id,op:"auth"};r.getEmpUserForm(e).then(function(e){e.data.empUser&&(p.initTools.empUser=e.data.empUser),p.initTools.role=e.data.roleList.length&&e.data.roleList[0].id,p.initTools.getCompanyTreeData(),p.initTools.getRoles()})}},p.initTools.getEmpUserForm(),p.initTools.type=o.type,p.initTools.type){case"ins":p.initTools.title="新增用户";break;case"sel":p.initTools.title="用户详情";break;case"upd":p.initTools.title="更新用户"}}angular.module("app.managerModule.user.opt").controller("UserOptController",e),e.$inject=["$scope","$stateParams","layer","API","session","MD5","$state","TEMPLATEDATA","JEEAPI"]}();